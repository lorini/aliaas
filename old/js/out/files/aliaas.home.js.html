<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>aliaas.home.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.1&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.5.1&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/AliaasBase.html">AliaasBase</a></li>
            
                <li><a href="..&#x2F;classes/AliaasDevice.html">AliaasDevice</a></li>
            
                <li><a href="..&#x2F;classes/AliaasHome.html">AliaasHome</a></li>
            
                <li><a href="..&#x2F;classes/AliaasRoom.html">AliaasRoom</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: aliaas.home.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;**
* Classe de la page principale d&#x27;ALiaaS 
* 
@class AliaasHome 
@constructor
@extends AliaasBase
**&#x2F;
function AliaasHome() {
   
    AliaasBase.call(this); 

    &#x2F;**
    * Canvas de l&#x27;heatmap 
    *
    * @attribute heatmap
    * @type object
    * @default null
    *&#x2F;
    this.heatmap = null ;
    
    &#x2F;**
    * Reset all heatmap and canvas except the #roomCanvas one.
    *
    @method eraseHeatmap
    @chainable
    **&#x2F;
    this.eraseHeatmap = function () {
        that = this ;
        delete heatmap;
        delete timeout;
        $heatmapCanvas = $(&#x27;canvas&#x27;).not(&quot;#roomCanvas&quot;) ; 
        $heatmapCanvas.fadeOut(1000,function () { $heatmapCanvas.remove(); that.initHeatmap(&#x27;heatmapArea&#x27;) ;});
        return this; 
    }

    &#x2F;**
    * Envoi les points de l&#x27;heatmap au proxy pour executer une commande
    *
    @method sendHeatmap
    @chainable
    **&#x2F;
    this.sendHeatmap = function(){
        that = this ; 
        var points = this.heatmap.store.exportDataSet().data;
        var json_text = JSON.stringify(points, null, 2);

        $.post(&quot;command.php?action=algov0&quot;, {
            image: $(&quot;canvas&quot;).not(&quot;#roomCanvas&quot;)[0].toDataURL(&quot;image&#x2F;png&quot;),
            action: &quot;heatpoints&quot;,
            heatmap: points
        }).success( function(){ 
            that.eraseHeatmap() ;
            &#x2F;&#x2F;noty({&quot;text&quot;:&quot;Aliaas s&#x27;est occupé de votre éclairage !&quot;,&quot;layout&quot;:&quot;topRight&quot;,&quot;theme&quot;:&quot;noty_theme_twitter&quot;,&quot;speed&quot;:0});
        });
        return this;
    }

    &#x2F;**
    * Initialise le canvas pour le dessin de l&#x27;heatmap.
    * Cette portion de code est dépendante de la librairie heatmap.js
    * (http:&#x2F;&#x2F;www.patrick-wied.at&#x2F;static&#x2F;heatmapjs&#x2F;).
    *
    @method initHeatmap
    @chainable
    **&#x2F;
    this.initHeatmap  = function (id){
            that=this;
            this.heatmap = h337.create({
                &quot;element&quot;: document.getElementById(id),
                &quot;radius&quot;: 150,
                &quot;visible&quot;: true
            });

            (function () {
                var active      = false,
                    mouseMove   = false,
                    mouseOver   = false,
                    activate    = function(){active = true;},
                    $           = function(id){return document.getElementById(id);},
                    timer       = null;

                var tmp = $(id);

                tmp.onmouseout = function () {
                    mouseOver = false;
                    if (timer) {
                        clearInterval(timer)
                        timer = null;
                    }
                };

                tmp.onmousemove = tmp.onclick = function (ev) {
                    mouseMove = true;
                    mouseOver = true;
                    if (active) {
                        if (timer) {
                            clearInterval(timer);
                            timer = null;
                        }
                        var pos = h337.util.mousePosition(ev);
                        that.heatmap.store.addDataPoint(pos[0], pos[1]);
                        active = false;
                    }
                    mouseMove = false;
                };

                tmp[&quot;ontouchmove&quot;] = function (ev) {
                    var touch = ev.touches[0],
                        simulatedEvent = document.createEvent(&quot;MouseEvent&quot;);
                    simulatedEvent.initMouseEvent(&quot;mousemove&quot;, true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, 0, null);
                    touch.target.dispatchEvent(simulatedEvent);
                    ev.preventDefault();
                };

                (function (fn) { setInterval(fn, 10);}(activate));
            })();
            return this;
        }

    this.initUI = function(){

          this.initHeatmap(&quot;heatmapArea&quot;) ; 

          $(&quot;#send&quot;).click(function(){aliaas.sendHeatmap();});
          $(&quot;#erase&quot;).click(function(){aliaas.eraseHeatmap();});
          $(&quot;#command&quot;).click(function(){aliaas.command();});
    }
}
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
